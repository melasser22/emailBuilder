server {
    listen 80;

    root /usr/share/nginx/html;

    index index.html;

    # Serve the React app from /ba
    location /email-builder-js/ {
        root /usr/share/nginx/html;  # Make sure this is the correct path to your React build
        try_files $uri /email-builder-js/index.html =404;  # If file not found, serve index.html

        # Optional: Add security headers
        add_header X-Content-Type-Options "nosniff";
        add_header X-XSS-Protection "1; mode=block";
        add_header Referrer-Policy "strict-origin-when-cross-origin";
        add_header Permissions-Policy "fullscreen=(self 'ne-sandbox.ejada.com');";
        add_header Content-Security-Policy "frame-ancestors 'self' ne-sandbox.ejada.com;";
        add_header X-Frame-Options "ALLOW-FROM ne-sandbox.ejada.com";
        #add_header Content-Security-Policy "default-src 'self'; object-src 'self' data:; script-src 'self' 'unsafe-eval'; style-src 'self'; img-src 'self' data:; frame-ancestors 'none'; report-uri /csp-report-endpoint;";
        #add_header X-Frame-Options "ALLOW-FROM ne-sandbox.ejada.com";
    }
 
    # Serve static assets
    location /email-builder-js/assets/ {
        alias /usr/share/nginx/html/assets/;
        valid_referers ne-sandbox.ejada.com;

        if ($invalid_referer) {
            return 403;
        }
    }

    error_page 404 /index.html;
}
